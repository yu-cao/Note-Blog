光线追踪希望能模拟光线在真实环境下的折射，反射，漫反射，间接反射等物理现象。如果我们能够模拟整个场景光线的传播，就能得到非常真实的图像，但如果直接从光源开始发射的光线经过传播后并不一定会进入摄像机，造成了大量计算浪费。使用逆向追踪——即从摄像机开始发射光线进行追踪，将有效减少无效计算，即使如此，计算量依然是巨大的，如果每一个像素点发射一条光线进行追踪，并且追踪10次折射或反射的话.生成一张1080P的图，相交的计算量将是 1920 * 1080 * 10 = 20 736 000，约两千万次光线追踪运算。单独看一个像素上的追踪过程的话:

+ 从视线方向发射一条射线。
+ 取得射线与场景最近的交点。
+ 取得交点的材质颜色。
+ 如果材质包含反射或折射，则改变光线方向。
+ 寻找下一个交点，并重复(2)。直到在场景内找不到交点，或达到最大追踪次数。

对于一些简单的示例场景中，可以简化为射线与球，或者射线与平面的相交。而在有模型的场景中，可以看作射线与场景中所有三角形进行相交，求最近的交点。

钻石的折射色散效果，其实是因为RGB每个通道的折射率有略微不同，对三个通道分别进行光线追踪，就能用很初级暴力的方式得到色散效果。

直接采用光线追踪，意味着每次追踪都需要对整个场景内的球体进行求交，当场景变得复杂时造成计算负担极大。

我在项目里采用AABB的方法，建立起BVH（边缘盒层次结构）可以让射线先对盒子求交，如果与盒子相交，再判断是否子包围盒相交，二分的思想可以避免每次相交都要与整个场景的三角形求交。

此外，我还加入提早结束循环的判断，与场景无交点时，或是颜色的Alpha值接近1时，不再进行后续相交操作。

渲染器!=光线追踪器，但是渲染器和光线追踪器有很多共通的地方，核心区别：一个面向物体，一个面向像素。

